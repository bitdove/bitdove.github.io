<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="Preface As we all know, overseas websites like Google and Twitter cannot be directly accessed in mainland China. We also know that you can access these websites by connecting to a VPN. As for the details, most people don&rsquo;t know, and there is really no need to know. But one thing we must understand is that an important reason why VPN can work is that GFW does not block all overseas websites. It is for this reason that we can find loopholes to exploit.\n">
<title>How to Build Proxy with XRay</title>

<link rel='canonical' href='https://MasonCodingHere.github.io/posts/how-to-build-proxy-with-xray/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="How to Build Proxy with XRay">
<meta property='og:description' content="Preface As we all know, overseas websites like Google and Twitter cannot be directly accessed in mainland China. We also know that you can access these websites by connecting to a VPN. As for the details, most people don&rsquo;t know, and there is really no need to know. But one thing we must understand is that an important reason why VPN can work is that GFW does not block all overseas websites. It is for this reason that we can find loopholes to exploit.\n">
<meta property='og:url' content='https://MasonCodingHere.github.io/posts/how-to-build-proxy-with-xray/'>
<meta property='og:site_name' content='Mason&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='VPS' /><meta property='article:tag' content='XRay' /><meta property='article:published_time' content='2024-09-18T16:26:03&#43;08:00'/><meta property='article:modified_time' content='2024-09-18T16:26:03&#43;08:00'/>
<meta name="twitter:title" content="How to Build Proxy with XRay">
<meta name="twitter:description" content="Preface As we all know, overseas websites like Google and Twitter cannot be directly accessed in mainland China. We also know that you can access these websites by connecting to a VPN. As for the details, most people don&rsquo;t know, and there is really no need to know. But one thing we must understand is that an important reason why VPN can work is that GFW does not block all overseas websites. It is for this reason that we can find loopholes to exploit.\n">
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "dark");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu16717790870751216787.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Mason&#39;s Blog</a></h1>
            <h2 class="site-description">Just do it.</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/bitdove'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#preface">Preface</a></li>
    <li><a href="#buy-a-vps">Buy a VPS</a>
      <ol>
        <li><a href="#choose-vps-type-and-location">Choose VPS Type and Location</a></li>
        <li><a href="#select-system-image">Select System Image</a></li>
        <li><a href="#choose-a-plan">Choose a Plan</a></li>
        <li><a href="#other-configs">Other Configs</a></li>
        <li><a href="#place-an-order">Place an order</a></li>
        <li><a href="#deployment-completed">Deployment Completed</a></li>
        <li><a href="#check-if-the-ip-is-blocked">Check if the IP is blocked</a></li>
      </ol>
    </li>
    <li><a href="#configuring-the-vps">Configuring the VPS</a>
      <ol>
        <li><a href="#ssh-login-to-vps">SSH login to VPS</a></li>
        <li><a href="#update">Update</a></li>
        <li><a href="#enable-ufw-firewall">Enable ufw firewall</a></li>
        <li><a href="#change-ssh-default-port">Change SSH default port</a></li>
        <li><a href="#set-up-key-only-login">Set up key-only login</a></li>
        <li><a href="#create-a-new-common-user">Create a new common user</a></li>
        <li><a href="#禁止root登录">禁止root登录</a></li>
        <li><a href="#安装fail2ban">安装Fail2Ban</a></li>
      </ol>
    </li>
    <li><a href="#xray安装与配置">XRay安装与配置</a>
      <ol>
        <li><a href="#install-xray">Install Xray</a></li>
        <li><a href="#config-xray">Config Xray</a></li>
      </ol>
    </li>
    <li><a href="#warp解锁chatgpt">Warp解锁ChatGPT</a></li>
    <li><a href="#references">References</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/solutions/" style="background-color: #2a9d8f; color: #fff;">
                Solutions
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/posts/how-to-build-proxy-with-xray/">How to Build Proxy with XRay</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2024/09/18</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    10 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="preface">Preface
</h1><p>As we all know, overseas websites like Google and Twitter cannot be directly accessed in mainland China. We also know that you can access these websites by connecting to a VPN. As for the details, most people don&rsquo;t know, and there is really no need to know. But one thing we must understand is that an important reason why VPN can work is that GFW does not block all overseas websites. It is for this reason that we can find loopholes to exploit.</p>
<blockquote>
<p>Technically speaking, VPN ≠ circumventing the Great Firewall. However, in mainland China, VPN has become synonymous with circumventing the Great Firewall, so I won’t go into details here.</p>
</blockquote>
<p>On the Internet, IP addresses are our &ldquo;identity cards&rdquo;. These banned overseas websites also have their own IP addresses, but unfortunately they are blocked by GFW, so we cannot access them directly. There are still some IP addresses that are not blocked and we can access them. A series of wall-climbing technologies are built on this basis.</p>
<p>Assume there is an IP address A, which is not blocked by GFW, and as a member of the Internet, A can access those blocked websites. We can send the request to access Google to A, and A will help us access it and then send the result to us. This is the principle of <strong>Proxy</strong>, and it is also the basis for a series of wall-circumvention technologies to be realized.</p>
<h1 id="buy-a-vps">Buy a VPS
</h1><p>First of all, we need an IP address that is not blocked. Purchasing an overseas VPS can meet this requirement. A VPS is actually a cloud server located overseas.</p>
<p>There are many VPS providers, such as BandWagon, Vultr, CloudCone, etc. This article takes Vultr as an example, and other manufacturers are similar.</p>
<p>Register and log in to <a class="link" href="https://www.vultr.com/"  target="_blank" rel="noopener"
    >Vultr</a>, click the Deploy button in the upper right corner and follow the steps below to deploy a VPS.</p>
<h2 id="choose-vps-type-and-location">Choose VPS Type and Location
</h2><p>Select Shared CPU as the type.</p>
<p>The location depends on your needs. Here we take Los Angeles, USA as an example.</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/select_type_and_location.png"
	
	
	
	loading="lazy"
	
		alt="select_type_and_location"
	
	
></p>
<h2 id="select-system-image">Select System Image
</h2><p>Choose an operating system. For a server, you should naturally choose Linux. Debian is recommended as it is more stable.</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/choose_image.png"
	
	
	
	loading="lazy"
	
		alt="choose_image"
	
	
></p>
<h2 id="choose-a-plan">Choose a Plan
</h2><p>Choose a configuration based on your needs. The higher the configuration, the more expensive it is. Here we choose the cheapest plan of 5$/month.</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/choose_plan.png"
	
	
	
	loading="lazy"
	
		alt="choose_plan"
	
	
></p>
<h2 id="other-configs">Other Configs
</h2><p>Remove Auto Backups, it costs money.</p>
<p>Remove IPv6, it is not needed.</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/additional_feature.png"
	
	
	
	loading="lazy"
	
		alt="additional_features"
	
	
></p>
<p>Here you can upload the SSH key and transfer the <strong>public key</strong> of your local computer <code>~/.ssh/</code> to Vultr. In this way, you can log in directly with the key after the deployment is completed without entering a password, which is much more convenient.</p>
<p>Set the host name in Server Hostname. You can give it a name of your own. This article takes Test as an example.</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/server_setting.png"
	
	
	
	loading="lazy"
	
		alt="server_settings"
	
	
></p>
<h2 id="place-an-order">Place an order
</h2><p>Now it’s ready. Confirm the quantity and price, and click Deploy Now to start deployment.</p>
<blockquote>
<p>The deployment process may take several minutes, so be patient.</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/order.png"
	
	
	
	loading="lazy"
	
		alt="order"
	
	
></p>
<h2 id="deployment-completed">Deployment Completed
</h2><p>When the Status changes to Running, the deployment is complete. The coded part is the public IP address of this VPS, which is represented by <code>100.200.300.400</code> below.</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/deploy.png"
	
	
	
	loading="lazy"
	
		alt="deploy"
	
	
></p>
<h2 id="check-if-the-ip-is-blocked">Check if the IP is blocked
</h2><p>Enter your IP address in <a class="link" href="https://ping.chinaz.com/"  target="_blank" rel="noopener"
    >Webmaster Tools - Ping Detection</a> and click Ping Detection. If most of the information is green, it means that your IP address is not blocked and you can use it with confidence.。</p>
<p>If it is all red, it means that this IP address has been blocked and cannot be used. According to the policy of your VPS manufacturer, find a way to change the IP until it is available.</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/pingcheck.png"
	
	
	
	loading="lazy"
	
		alt="pingcheck"
	
	
></p>
<h1 id="configuring-the-vps">Configuring the VPS
</h1><h2 id="ssh-login-to-vps">SSH login to VPS
</h2><p>To configure your VPS, first log in to your VPS via SSH. Open your terminal tool and enter the following command to log in to your VPS.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh root@100.200.300.400
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>SSH logging into a Linux server is a basic operation and will not be explained in detail.</p>
</blockquote>
<h2 id="update">Update
</h2><p>Update your package index and then upgrade all installed packages to their latest versions, ensuring your system is up to date with the latest features and security patches.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt update
</span></span><span class="line"><span class="cl">apt upgrade
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="enable-ufw-firewall">Enable ufw firewall
</h2><p>The first thing to do after logging in is to enable the ufw firewall. First, confirm whether ufw has been installed. Execute the following command. If the ufw version number is returned, it means it has been installed.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ufw --version
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>If ufw is not installed, install it yourself.</p>
</blockquote>
<p>Run the following command to configure ufw.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Setting ufw defaults</span>
</span></span><span class="line"><span class="cl">sudo ufw default deny incoming
</span></span><span class="line"><span class="cl">sudo ufw default allow outgoing
</span></span><span class="line"><span class="cl"><span class="c1"># Allow SSH connections</span>
</span></span><span class="line"><span class="cl">sudo ufw allow ssh
</span></span><span class="line"><span class="cl"><span class="c1"># Allow HTTP connections</span>
</span></span><span class="line"><span class="cl">sudo ufw allow http
</span></span><span class="line"><span class="cl"><span class="c1"># Allow HTTPS connections</span>
</span></span><span class="line"><span class="cl">sudo ufw allow https
</span></span><span class="line"><span class="cl"><span class="c1"># Startup</span>
</span></span><span class="line"><span class="cl">sudo ufw <span class="nb">enable</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Other common ufw commands：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Check ufw status</span>
</span></span><span class="line"><span class="cl">sudo ufw status
</span></span><span class="line"><span class="cl"><span class="c1"># ufw status output with line number, and delete a line</span>
</span></span><span class="line"><span class="cl">sudo ufw status numbered
</span></span><span class="line"><span class="cl">sudo ufw delete <span class="m">5</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Reload ufw configuration</span>
</span></span><span class="line"><span class="cl">sudo ufw reload
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="change-ssh-default-port">Change SSH default port
</h2><ol>
<li>Open an editor such as nano or vim and open the file <code>/etc/ssh/sshd_config</code></li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim /etc/ssh/sshd_config
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>Find the item <code>Port</code> in the opened file, remove the comment symbol <code>#</code>, and change 22 to the new port number (1025-65535). This article takes 9753 as an example.</li>
</ol>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/changeport.png"
	
	
	
	loading="lazy"
	
		alt="changeport"
	
	
></p>
<ol start="3">
<li>Restart the ssh service for the changes to take effect.</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">service sshd restart
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="4">
<li>Open new port number on firewall</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ufw allow 9753/tcp comment <span class="s2">&#34;SSH&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="5">
<li>Delete the original port 22 in the firewall. The figure below deletes <code>22/tcp</code>. Use the same method to delete <code>22/tcp(v6)</code>.</li>
</ol>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/delete_port22.png"
	
	
	
	loading="lazy"
	
		alt="delete_port22"
	
	
></p>
<ol start="6">
<li>
<p>Test the new port number login</p>
<blockquote>
<p>Note: To ensure that you do not lose connection, please do not close the current ssh login window! Instead, open another window to test!</p>
</blockquote>
<p>In a new terminal window, log in to the VPS using the new port number.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh root@100.200.300.400 -p <span class="m">9753</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="set-up-key-only-login">Set up key-only login
</h2><ol>
<li>Upload the public key to the VPS.</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Create a new .ssh folder in your home directory</span>
</span></span><span class="line"><span class="cl">mkdir ~/.ssh
</span></span><span class="line"><span class="cl"><span class="c1"># Modify the .ssh folder permissions</span>
</span></span><span class="line"><span class="cl">chmod <span class="m">700</span> ~/.ssh
</span></span><span class="line"><span class="cl"><span class="c1"># Upload the public key. Replace the content in quotation marks with the public key value</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Your public key content&#34;</span> &gt;&gt; ~/.ssh/authorized_keys
</span></span><span class="line"><span class="cl"><span class="c1"># Modify the permissions of the authorized_keys file</span>
</span></span><span class="line"><span class="cl">chmod <span class="m">600</span> ~/.ssh/authorized_keys
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>Disable password login</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim /etc/ssh/sshd_config
</span></span></code></pre></td></tr></table>
</div>
</div><p>Find the item <code>PasswordAuthentication</code>, uncomment it and change it to <code>no</code>, then save and exit.</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/banpasswdlogin.png"
	
	
	
	loading="lazy"
	
		alt="banpasswdlogin"
	
	
></p>
<p>For some systems, it is useless to change only this one, and you also need to change the following one. If the system does not have this file, ignore this step.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim /etc/ssh/sshd_config.d/50-cloud-init.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p>Similarly, uncomment the PasswordAuthentication option and change it to no, then save and exit.</p>
<ol start="3">
<li>Restart the ssh service for the changes to take effect.</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">service sshd restart
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="4">
<li>Test key login.</li>
</ol>
<p>Open a new terminal and log into the VPS using the following command.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh -i path/to/yourprivatekeyname -p <span class="m">9753</span> root@100.200.300.400
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Change <code>path/to/yourprivatekeyname</code> to the path of the private key corresponding to the public key used by the VPS. Usually it is under <code>~/.ssh/</code>.</p>
</blockquote>
<h2 id="create-a-new-common-user">Create a new common user
</h2><ol>
<li>Execute the following command to create a new user. Follow the prompts to complete the process.</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">adduser leo
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Give the new user a name. This article uses <code>leo</code> as an example.</p>
</blockquote>
<ol start="2">
<li>Add new user <code>leo</code> to <code>sudo</code>.</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">visudo
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/addsudo.png"
	
	
	
	loading="lazy"
	
		alt="addsudo"
	
	
></p>
<ol start="3">
<li>Give the public key to the new user.</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 切换至新用户leo</span>
</span></span><span class="line"><span class="cl">su leo
</span></span><span class="line"><span class="cl"><span class="c1"># 在新用户leo家目录下创建.ssh文件夹</span>
</span></span><span class="line"><span class="cl">mkdir ~/.ssh
</span></span><span class="line"><span class="cl"><span class="c1"># 修改.ssh文件夹权限</span>
</span></span><span class="line"><span class="cl">chmod <span class="m">700</span> ~/.ssh
</span></span><span class="line"><span class="cl"><span class="c1"># 上传公钥。将引号内的内容替换为公钥值</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;公钥内容&#34;</span> &gt;&gt; ~/.ssh/authorized_keys
</span></span><span class="line"><span class="cl"><span class="c1"># 修改authorized_keys文件权限</span>
</span></span><span class="line"><span class="cl">chmod <span class="m">600</span> ~/.ssh/authorized_keys
</span></span></code></pre></td></tr></table>
</div>
</div><p>这样新用户就可以用密钥登陆了。</p>
<h2 id="禁止root登录">禁止root登录
</h2><p>打开<code>/etc/ssh/sshd_config</code>，找到<code>PermitRootLogin</code>这一项，解注释并将<code>yes</code>改为<code>no</code>。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vim /etc/ssh/sshd_config
</span></span></code></pre></td></tr></table>
</div>
</div><p>重启sshd服务，使变更生效。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo service sshd restart
</span></span></code></pre></td></tr></table>
</div>
</div><p>这样，root用户就无法登陆了，以后用<code>leo</code>用户管理VPS。</p>
<h2 id="安装fail2ban">安装Fail2Ban
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 安装Fail2Ban</span>
</span></span><span class="line"><span class="cl">sudo apt update <span class="o">&amp;&amp;</span> sudo apt install fail2ban
</span></span><span class="line"><span class="cl"><span class="c1"># 建配置文件</span>
</span></span><span class="line"><span class="cl">sudo nano /etc/fail2ban/jail.local
</span></span><span class="line"><span class="cl"><span class="c1"># 将以下内容粘贴在打开文件中</span>
</span></span><span class="line"><span class="cl">******粘贴内容开始******
</span></span><span class="line"><span class="cl"><span class="o">[</span>sshd<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">enabled</span> <span class="o">=</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">port</span> <span class="o">=</span> <span class="m">9753</span>
</span></span><span class="line"><span class="cl"><span class="nv">filter</span> <span class="o">=</span> sshd
</span></span><span class="line"><span class="cl"><span class="nv">logpath</span> <span class="o">=</span> /var/log/auth.log
</span></span><span class="line"><span class="cl"><span class="nv">maxretry</span> <span class="o">=</span> <span class="m">5</span>
</span></span><span class="line"><span class="cl"><span class="nv">bantime</span> <span class="o">=</span> <span class="m">7200</span>
</span></span><span class="line"><span class="cl"><span class="nv">findtime</span> <span class="o">=</span> <span class="m">600</span>
</span></span><span class="line"><span class="cl">******粘贴内容结束******
</span></span><span class="line"><span class="cl"><span class="c1"># 启动Fail2Ban</span>
</span></span><span class="line"><span class="cl">sudo systemctl start fail2ban
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>上述配置的意思是：600秒内5次尝试登陆ssh的IP地址会被判7200秒有期徒刑。</p>
</blockquote>
<p><code>Fail2Ban</code>常用命令:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 重启Fail2Ban</span>
</span></span><span class="line"><span class="cl">sudo systemctl restart fail2ban
</span></span><span class="line"><span class="cl"><span class="c1"># 查看fail2ban服务状态</span>
</span></span><span class="line"><span class="cl">sudo systemctl status fail2ban
</span></span><span class="line"><span class="cl"><span class="c1"># 将Fail2Ban设为开机启动</span>
</span></span><span class="line"><span class="cl">sudo systemctl <span class="nb">enable</span> fail2ban
</span></span><span class="line"><span class="cl"><span class="c1"># 查看状态</span>
</span></span><span class="line"><span class="cl">sudo fail2ban-client status
</span></span><span class="line"><span class="cl"><span class="c1"># 查看sshd jail的详细状态</span>
</span></span><span class="line"><span class="cl">sudo fail2ban-client status sshd
</span></span><span class="line"><span class="cl"><span class="c1"># 解禁指定IP</span>
</span></span><span class="line"><span class="cl">sudo fail2ban-client <span class="nb">set</span> sshd unbanip 192.0.0.1
</span></span></code></pre></td></tr></table>
</div>
</div><p>至此，VPS安全配置已经完成。接下开是真正的搭梯子环节。</p>
<h1 id="xray安装与配置">XRay安装与配置
</h1><p>不推荐用任何一键脚本，谁知道里边有没有藏什么东西。官方文档足够详细，安装配置足够简单。此部分详细内容可查阅<a class="link" href="https://xtls.github.io/document/"  target="_blank" rel="noopener"
    >官方文档</a>。</p>
<h2 id="install-xray">Install Xray
</h2><p>GitHub仓库<a class="link" href="https://github.com/XTLS/Xray-install"  target="_blank" rel="noopener"
    >Xray-install</a>是<a class="link" href="https://github.com/XTLS"  target="_blank" rel="noopener"
    >Xray官方</a>提供的安装方式，在仓库<code>README</code>页可以找到官方安装脚本：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bash -c <span class="s2">&#34;</span><span class="k">$(</span>curl -L https://github.com/XTLS/Xray-install/raw/main/install-release.sh<span class="k">)</span><span class="s2">&#34;</span> @ install
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>后期更新新版本也是这个命令。</p>
</blockquote>
<p>一键安装，足够简单吧。</p>
<h2 id="config-xray">Config Xray
</h2><ol>
<li>
<p>生成一个合法的 <code>UUID</code> 并保存备用（<code>UUID</code>可以简单粗暴的理解为像指纹一样几乎不会重复的 ID）。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">xray uuid
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/uuidgennerate.png"
	
	
	
	loading="lazy"
	
		alt="uuidgenerate"
	
	
></p>
<p>这个<code>uuid</code>要留存，后边配置会用到。</p>
</li>
<li>
<p>修改Xray配置文件。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo nano /usr/local/etc/xray/config.json
</span></span></code></pre></td></tr></table>
</div>
</div><p>将以下内容粘贴进去。只需修改<code>port</code>和<code>id</code>两项。本文<code>port</code>以<code>12345</code>为例，<code>id</code>以上一步生成的为例。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">#</span> <span class="err">原始版本，VMess+Kcp，访问不了ChatGPT客户端</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;log&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;loglevel&#34;</span><span class="p">:</span> <span class="s2">&#34;warning&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;access&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/log/xray/access.log&#34;</span><span class="p">,</span> <span class="c1">// 这是 Linux 的路径
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;error&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/log/xray/error.log&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;inbounds&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;port&#34;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span> <span class="c1">// 服务器监听端口
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;vmess&#34;</span><span class="p">,</span>    <span class="c1">// 主传入协议
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;clients&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;0061c282-49f7-41d7-b223-0a9b6d8675dd&#34;</span><span class="p">,</span>  <span class="c1">// uuid，客户端与服务器必须相同
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nt">&#34;alterId&#34;</span><span class="p">:</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;streamSettings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;network&#34;</span><span class="p">:</span> <span class="s2">&#34;kcp&#34;</span><span class="p">,</span> <span class="c1">//此处的 kcp 也可写成 mkcp，两种写法是起同样的效果
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nt">&#34;kcpSettings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;uplinkCapacity&#34;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;downlinkCapacity&#34;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;congestion&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;readBufferSize&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;writeBufferSize&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;header&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wireguard&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;outbounds&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;freedom&#34;</span><span class="p">,</span>  <span class="c1">// 主传出协议
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;settings&#34;</span><span class="p">:</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>开放在配置文件中指定的端口号。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo ufw allow 12345/tcp comment <span class="s2">&#34;XRay&#34;</span>
</span></span><span class="line"><span class="cl">sudo ufw allow 12345/udp comment <span class="s2">&#34;XRay&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/openport12345.png"
	
	
	
	loading="lazy"
	
		alt="openport12345"
	
	
></p>
</li>
<li>
<p>启动Xray</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 启动XRay</span>
</span></span><span class="line"><span class="cl">sudo systemctl start xray
</span></span><span class="line"><span class="cl"><span class="c1"># 将XRay设为开机启动</span>
</span></span><span class="line"><span class="cl">sudo systemctl <span class="nb">enable</span> xray
</span></span><span class="line"><span class="cl"><span class="c1"># 查看XRay运行状态</span>
</span></span><span class="line"><span class="cl">sudo systemctl status xray
</span></span></code></pre></td></tr></table>
</div>
</div><p>看到下图这样绿色的<code>active(running)</code>就说明XRay已成功启动，这样服务端就配置好了。</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/startxray.png"
	
	
	
	loading="lazy"
	
		alt="startxray"
	
	
></p>
</li>
<li>
<p>开启BBR加速。</p>
<p>给 Debian 10 添加官方 <code>backports</code> 源，获取更新的软件库。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo nano /etc/apt/sources.list
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后把下面这一条加在最后，并保存退出。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">deb http://archive.debian.org/debian buster-backports main
</span></span></code></pre></td></tr></table>
</div>
</div><p>刷新软件库并查询 Debian 官方的最新版内核并安装。请务必安装你的 VPS 对应的版本（本文以比较常见的【amd64】为例）。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt update <span class="o">&amp;&amp;</span> sudo apt -t buster-backports install linux-image-amd64
</span></span></code></pre></td></tr></table>
</div>
</div><p>修改 <code>kernel</code> 参数配置文件 <code>sysctl.conf</code> 并指定开启 <code>BBR</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo nano /etc/sysctl.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p>把下面的内容添加进去</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">net.core.default_qdisc=fq
</span></span><span class="line"><span class="cl">net.ipv4.tcp_congestion_control=bbr
</span></span></code></pre></td></tr></table>
</div>
</div><p>重启 VPS、使内核更新和<code>BBR</code>设置都生效。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo reboot
</span></span></code></pre></td></tr></table>
</div>
</div><p>确认<code>BBR</code>开启。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">lsmod <span class="p">|</span> grep bbr
</span></span></code></pre></td></tr></table>
</div>
</div><p>此时应该返回<code>tcp_bbr</code>这样的结果。</p>
<p>如果你想确认 <code>fq</code> 算法是否正确开启，可以使用下面的命令：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">lsmod <span class="p">|</span> grep fq
</span></span></code></pre></td></tr></table>
</div>
</div><p>此时应该返回<code>sch_fq</code>这样的结果。</p>
</li>
<li>
<p>配置客户端。</p>
<p>服务端配置结束，接下来就是在你的客户端进行配置。根据客户端用的代理工具不同，配置方法也不太一样。但全都是根据服务端的配置进行。主要是把<code>IP:Port</code>和<code>uuid</code>配置为与服务端一致。</p>
<blockquote>
<p>客户端配置就不细讲了。</p>
</blockquote>
<p>这样，就已经可以科学上网了。只是无法使用ChatGPT客户端，因为ChatGPT对这些VPS厂商的IP进行了封锁。</p>
</li>
</ol>
<h1 id="warp解锁chatgpt">Warp解锁ChatGPT
</h1><blockquote>
<p>ChatGPT封锁了VPS厂商的IP地址，而Cloudflare的Warp可以提供供我们使用的IP地址，所以我们用Warp提供的IP地址去访问ChatGPT。但是，Warp提供的IPv4地址已经被滥用，也无法访问ChatGPT客户端了，所以我们用Warp IPv6。目标是访问寻常网站时用VPS的公网IPv4地址，访问ChatGPT时用Warp的IPv6地址。</p>
</blockquote>
<p>执行下面这个脚本安装WGCF。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget -N https://gitlab.com/fscarmen/warp/-/raw/main/menu.sh <span class="o">&amp;&amp;</span> bash menu.sh
</span></span></code></pre></td></tr></table>
</div>
</div><p>根据需要选择语言，本文选中文了。</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/choose.png"
	
	
	
	loading="lazy"
	
		alt="chooselanguage"
	
	
></p>
<p>因为我们这台VPS是IPv4 only的机器，没有IPv6地址，我们仅需要Warp提供IPv6地址，所以选择2. 为IPv4 only添加Warp IPv6网络接口。</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/add.png"
	
	
	
	loading="lazy"
	
		alt="addv6forv4only"
	
	
></p>
<p>工作模式选1.全局（默认）即可。</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/workmode.png"
	
	
	
	loading="lazy"
	
		alt="workmode"
	
	
></p>
<p>选择账户类型。这里根据自己的需要选择，我自己有WARP的团队版，即Zero Trust，所以选择3. Teams。</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/loginaccount.png"
	
	
	
	loading="lazy"
	
		alt="accountchoose"
	
	
></p>
<p>接下来就是登陆选择的账户。Teams账户选择2.通过组织名和邮箱验证码来登陆是比较方便的。</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/logincf.png"
	
	
	
	loading="lazy"
	
		alt="login"
	
	
></p>
<p>优先级别选择3.使用VPS初始设置（默认）即可。</p>
<p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/choose46priority.png"
	
	
	
	loading="lazy"
	
		alt="46"
	
	
></p>
<p>这样WGCF会开始安装，等待安装完成，运行下面的命令，可以看到有一个叫<code>warp</code>的网卡。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo ifconfig
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://raw.githubusercontent.com/bitdove/PicsBed_1/main/BuildYourOwnLadder/warpinter.png"
	
	
	
	loading="lazy"
	
		alt="warpcard"
	
	
></p>
<p>这样VPS就有IPv6地址了。</p>
<p>修改XRay的配置文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo nano /usr/local/etc/xray/config.json
</span></span></code></pre></td></tr></table>
</div>
</div><p>用下面的内容覆盖。将<code>IPv4</code>地址替换为你的VPS公网IPv4地址，将<code>IPv6</code>地址替换为warp网卡的地址。<code>uuid</code>和<code>port</code>也要替换为自己的。其他的不用更改。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">#</span> <span class="err">Warp接管IPv</span><span class="mi">6</span><span class="err">流量版本，VMess+Kcp，解锁ChatGPT客户端</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;log&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;loglevel&#34;</span><span class="p">:</span> <span class="s2">&#34;warning&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;access&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/log/xray/access.log&#34;</span><span class="p">,</span> <span class="c1">// 这是 Linux 的路径
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;error&#34;</span><span class="p">:</span> <span class="s2">&#34;/var/log/xray/error.log&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;inbounds&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;port&#34;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span> <span class="c1">// 服务器监听端口
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;vmess&#34;</span><span class="p">,</span>    <span class="c1">// 主传入协议
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;clients&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;0061c282-49f7-41d7-b223-0a9b6d8675dd&#34;</span><span class="p">,</span>  <span class="c1">// uuID，客户端与服务器必须相同
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nt">&#34;alterId&#34;</span><span class="p">:</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;streamSettings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;network&#34;</span><span class="p">:</span> <span class="s2">&#34;kcp&#34;</span><span class="p">,</span> <span class="c1">//此处的 kcp 也可写成 mkcp，两种写法是起同样的效果
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nt">&#34;kcpSettings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;uplinkCapacity&#34;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;downlinkCapacity&#34;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;congestion&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;readBufferSize&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;writeBufferSize&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;header&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;wireguard&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;outbounds&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;freedom&#34;</span><span class="p">,</span>  <span class="c1">// 主传出协议
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;domainStrategy&#34;</span><span class="p">:</span> <span class="s2">&#34;UseIPv4&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;sendThrough&#34;</span><span class="p">:</span> <span class="s2">&#34;100.200.300.400&#34;</span> <span class="c1">//VPS公网IPv4地址
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;tag&#34;</span><span class="p">:</span> <span class="s2">&#34;warp&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;freedom&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;domainStrategy&#34;</span><span class="p">:</span> <span class="s2">&#34;UseIPv6&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;sendThrough&#34;</span><span class="p">:</span> <span class="s2">&#34;2606:4700:110:88b8:5141:4387:4a3:20d1&#34;</span> <span class="c1">//warp网卡IPv6地址
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;routing&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;rules&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;domain&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;geosite:openai&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;geosite:bing&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;geosite:netflix&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;outboundTag&#34;</span><span class="p">:</span> <span class="s2">&#34;warp&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;field&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>重启XRay，并确认Xray已成功运行。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo systemctl start xray
</span></span><span class="line"><span class="cl">sudo systemctl status xray
</span></span></code></pre></td></tr></table>
</div>
</div><p>在客户端连接该节点，可以发现ChatGPT客户端已经可以正常使用。</p>
<h1 id="references">References
</h1><blockquote>
<ol>
<li><a class="link" href="https://xtls.github.io/document/"  target="_blank" rel="noopener"
    >Project X官方文档</a></li>
<li><a class="link" href="https://blog.laoda.de/archives/how-to-secure-a-linux-server"  target="_blank" rel="noopener"
    >保护好你的小鸡！保姆级服务器安全教程！</a></li>
<li><a class="link" href="https://cn.v2ex.com/t/942922"  target="_blank" rel="noopener"
    >vps 解锁 chatgpt</a></li>
<li><a class="link" href="https://surge.tel/13/2116/"  target="_blank" rel="noopener"
    >注册Cloudflare并加入ZeroTrust教程</a></li>
</ol>
</blockquote>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/vps/">VPS</a>
        
            <a href="/tags/xray/">XRay</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/posts/build-your-blog/">
        
        

        <div class="article-details">
            <h2 class="article-title">Hugo &#43; GitHub Pages搭建个人博客</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2024 Mason
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.27.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
